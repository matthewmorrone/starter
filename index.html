<html>
<head>
<meta charset="utf-8">
<icon src='psi.ico'></icon>
<script src="https://cdn.polyfill.io/v1/polyfill.min.js"></script>
<!-- <script src='load.js'></script> -->
<script src="./js/coffeescript.js"></script>
<script src="./js/livescript.js"></script>

<script src="./js/jquery.js"></script>
<script src="./js/jquery.helpers.js"></script>
<script src="./js/lodash.js"></script>
<script src="./js/backbone.js"></script>
<script src="./js/chroma.js"></script>
<script src="./js/q.js"></script>
<script src="./js/d3.js"></script>
<script src="./js/sigma.js"></script>



<script src="./js/sass.js"></script>
<script> less = {async: false }; </script>
<script src="./js/less.js"></script>
<script src="./js/stylus.js"></script>
<link type="text/css" rel="stylesheet" href="./css/reset.css">
<link type="text/css" rel="stylesheet" href="./css/normal.css">
<link type="text/css" rel="stylesheet" href="./css/bootstrap.css">
<script>
var log = console.log.bind(console); // function log() {console.log(arguments);};



$(function() {

	$("coffeescript").each(function() {
		var $this = $(this)[0];
		var script = $("<script><\/script>", {type: "text\/javascript"}).text(CoffeeScript.compile($this.text()));
		$this.replaceWith(script);
	});



	var LiveScript = require("LiveScript");
	$("livescript").each(function() {
		var $this = $(this);
		var script = $("<script><\/script>", {type: "text\/livescript"}).text($this.text());
		$this.replaceWith(script);
	});
	LiveScript.compile();
	LiveScript.go();

	$("sass").each(function() {
		var input = $(this)[0];
		var style = document.createElement("style");
		style.innerHTML = "/* from sass*/\n\n"+Sass.compile(input.innerHTML);
		input.parentNode.replaceChild(style, input);
		log("sass works");
	});


	$("stylus").each(function() {
		var input = $(this)[0];
		var rendered = stylus.render(input.innerHTML);
		var style = document.createElement("style");
		style.innerHTML = "/* from stylus*/\n\n"+rendered;
		input.parentNode.replaceChild(style, input);
		log("stylus works");
	})

	// try and make this async
	$("less").each(function() {
		var input = $(this)[0];
		less.render(input.innerHTML).then(function(output) {
			var style = document.createElement("style");
			style.innerHTML = "/* from less*/\n\n"+output.css;
			input.parentNode.replaceChild(style, input);
			log("less works");
		});
	});

	$("style").each(function () {
		var style = $(this);
		var link = $("<link \/>", {
			rel: "stylesheet",
			type: "text\/css"
		});
		var styles = $("<style><\/style>");

		if (style.src() !== "") {
			if (style.text() == "") {
				link.href(style.src());
				// $("head").append(link);
			} else {
				link.attr("href", style.src());
				styles.text(style.text());
				// $("head").append(link);
				// $("head").append(styles);
			}
			// style.remove();

		}
	});

	$("icon").each(function () {
		var icon = $(this);
		var link = $("<link \/>", {
			href: icon.src(),
			rel: "icon",
			type: "image\/png"
		});
		icon.remove();
		$("head").append(link);
	});

	$("fragment[data-src]").each(function () {
		var src = $(this);
		$.post(src.attr("data-src"), function (data) {
			src.html(data);
		});
	});



});



</script>


</head>
<body>





<coffeescript>

# Assignment:
number	 = 42
opposite = true

# Conditions:
number = -42 if opposite

# Functions:
square = (x) -> x * x

# Arrays:
list = [1, 2, 3, 4, 5]

# Objects:
math =
	root:	 Math.sqrt
	square: square
	cube:	 (x) -> x * square x

# Splats:
race = (winner, runners...) ->
	print winner, runners

# Existence:
alert "I knew it!" if elvis?

# Array comprehensions:
cubes = (math.cube num for num in list)

console.log "coffeescript works"

</coffeescript>
<livescript>


switch 6
case 1		then out = \hello
case 2, 4 then out = \boom
case 6
	out = 'here it is'
default out = \something

console.log "livescript works"

</livescript>
<script type="text/typescript">

class Greeter {
	greeting: string;
	constructor(message: string) {
		this.greeting = message;
	}
	greet() {
		return "Hello, " + this.greeting;
	}
}

var greeter = new Greeter("world");

var button = document.createElement('button');
button.textContent = "Say Hello";
button.onclick = function() {
	alert(greeter.greet());
}

// document.body.appendChild(button);

console.log("typescript works");

</script>
<script src="./js/typescript.js"></script>
<script src="./js/typescript.compile.js"></script>



<sass>

$someVar: 123px;
.some-selector
{
	width: $someVar;
}

$foo: 10px;
.selector
{
	margin: $foo;
	.nested
	{
		margin: $foo / 2;
	}
}


</sass>
<less>

@color: white;
p {
	color: @color;
}
.class {
	width: (1 + 1);
}
body {
	background-color: @color;
}

</less>
<stylus>

body {
	font: 14px/1.5 Helvetica, arial, sans-serif;
	#logo {
		border-radius: 5px;
	}
}


</stylus>



</body>
</html>
