<html>
<head>
<meta charset="utf-8">
<icon src='psi.ico'></icon>
<script src="https://cdn.polyfill.io/v1/polyfill.min.js"></script>
<script src='load.js'></script>
<script>
var log = console.log.bind(console); // function log() {console.log(arguments);};

var jsFiles = [	'jquery', 'lodash', 'chroma', 'd3', 'sigma'];
var cssPreprocessors = ['sass', 'less',	'stylus'];

var jsPreprocessors = ['coffeescript', 'livescript'];
var cssFiles = ['reset', 'normal', 'bootstrap'];

log(load.js(jsPreprocessors, "js"));
log(load.js(jsFiles, "js"));

log(load.js(cssPreprocessors, "js"));
log(load.css(cssFiles, "css"));


$(function() {

	// $("coffeescript").each(function() {
	// 	var $this = $(this);
	// 	var script = $("<script><\/script>", {type: "text\/javascript"}).text(CoffeeScript.compile($this.text()));
	// 	$this.replaceWith(script);
	// });
	// var LiveScript = require("LiveScript");
	// $("livescript").each(function() {
	// 	var $this = $(this);
	// 	var script = $("<script><\/script>", {type: "text\/javascript"}).text(LiveScript.compile($this.text()));
	// 	$this.replaceWith(script);
	// });






	$("style").each(function () {
		var style = $(this);
		var link = $("<link \/>", {
			rel: "stylesheet",
			type: "text\/css"
		});
		var styles = $("<style><\/style>");

		if (style.src() !== "") {
			if (style.text() == "") {
				link.href(style.src());
				$("head").append(link);
			} else {
				link.attr("href", style.src());
				styles.text(style.text());
				$("head").append(link);
				$("head").append(styles);
			}
		}
		style.remove();
	});

	$("icon").each(function () {
		var icon = $(this);
		var link = $("<link \/>", {
			href: icon.src(),
			rel: "icon",
			type: "image\/png"
		});
		icon.remove();
		$("head").append(link);
	});

	$("fragment[data-src]").each(function () {
		var src = $(this);
		$.post(src.attr("data-src"), function (data) {
			src.html(data);
		});
	});

});




</script>

</head>
<body>





<coffeescript>

# Assignment:
number   = 42
opposite = true

# Conditions:
number = -42 if opposite

# Functions:
square = (x) -> x * x

# Arrays:
list = [1, 2, 3, 4, 5]

# Objects:
math =
  root:   Math.sqrt
  square: square
  cube:   (x) -> x * square x

# Splats:
race = (winner, runners...) ->
  print winner, runners

# Existence:
alert "I knew it!" if elvis?

# Array comprehensions:
cubes = (math.cube num for num in list)

</coffeescript>
<livescript>

func = (num) ->
  switch num
  case 2, 4, 6
	Boolean true
  case [1, 3, 5]
	Boolean false
  default
eq func(2), true
eq func(6), true
eq func(3), false
eq func(8), void

</livescript>
<typescript>

class Greeter {
	greeting: string;
	constructor(message: string) {
		this.greeting = message;
	}
	greet() {
		return "Hello, " + this.greeting;
	}
}

var greeter = new Greeter("world");

var button = document.createElement('button');
button.textContent = "Say Hello";
button.onclick = function() {
	alert(greeter.greet());
}

document.body.appendChild(button);

</typescript>
</body>
</html>
